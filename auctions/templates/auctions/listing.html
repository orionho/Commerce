{% extends "auctions/layout.html" %}

{% block body %}
    <h1>{{ listing.title }}</h1>
    Category: <a href="{% url 'display_category' listing.category %}">{{ listing.category }}</a>
    <h4>Description: {{ listing.description }}</h4>
    <h4>Starting price: {{ listing.startingbid }}</h4>
    <h3>Current Bid: {{ listing.highest_bid.amount }}</h3>
    <br>
    <form method="POST" action="{% url 'place_bid' listing.id %}">
        {% csrf_token %}
        <label for="bid_amount">Bid Amount:</label>
        <input type="number" name="bid_amount" min="{{ listing.highest_bid }}" step="0.01" required>
        <input type="submit" value="Place Bid"> 
    </form>
    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}
    <img src ="{{ listing.item_img.url }}" class="img-responsive" alt="{{ title }}" style="max-height:300px">
    {% if user in listing.watchlist_user.all %}
        <form method="POST" action="{% url 'remove_from_watchlist' listing.id %}">
            {% csrf_token %}
            <input type="submit" value="Remove from Watchlist">
        </form>
    {% else %}
        <form method="POST" action="{% url 'add_to_watchlist' listing.id %}">
            {% csrf_token %}
            <input type="submit" value="Add to Watchlist">
        </form>
    {% endif %}
    {% for comment in comments %}
        <p>{{ comment }}</p>
        <h6>User: {{ comment.user }}</h6>
        <h6>Date: {{ comment.timestamp }}</h6>
    {% endfor %}
<form action="{% url 'add_comment' listing.id %}" method="post">
    {% csrf_token %}
    <textarea name="comment" rows="4" cols="50"></textarea>
    <input type="submit" value="Submit">
  </form>
{% endblock %}

{% block owner %}
{% endblock %}
